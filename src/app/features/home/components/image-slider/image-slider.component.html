<div
  class="slider-container"
  #sliderContainer
  (touchstart)="onTouchStart($event)"
  (touchmove)="onTouchMove($event)"
  (touchend)="onTouchEnd()"
  role="region"
  aria-label="Image Slider"
>
  <!-- Slides container -->
  <div class="slides-wrapper">
    <div
      class="slide"
      *ngFor="let image of images; let i = index"
      [class.active]="i === currentIndex"
      [attr.aria-hidden]="i !== currentIndex"
    >
      <div class="slide-content">
        <!-- Loading skeleton for when image is not loaded -->
        <div class="image-skeleton" *ngIf="!image.loaded" [class.hide]="image.loaded">
          <div class="skeleton-animation"></div>
          <div class="loading-text">Loading...</div>
        </div>
        
        <picture [class.image-loaded]="image.loaded">
          <!-- WebP format for modern browsers on mobile -->
          <source
            [srcset]="image.srcMobileWebp"
            media="(max-width: 768px)"
            type="image/webp"
          />
          <!-- JPEG fallback for mobile -->
          <source
            [srcset]="image.srcMobile"
            media="(max-width: 768px)"
            type="image/jpeg"
          />
          <!-- WebP format for modern browsers on desktop -->
          <source
            [srcset]="image.srcWebp"
            media="(min-width: 769px)"
            type="image/webp"
          />
          <!-- JPEG fallback for desktop -->
          <source
            [srcset]="image.src"
            media="(min-width: 769px)"
            type="image/jpeg"
          />
          <!-- Default fallback image -->
          <img
            [src]="image.src"
            [alt]="image.alt"
            (error)="handleImageError($event)"
            [attr.loading]="i === 0 ? 'eager' : 'lazy'"
            [attr.fetchpriority]="i === 0 ? 'high' : 'auto'"
            class="slide-image"
            (load)="onImageLoad(i)"
            [class.loaded]="image.loaded"
          />
        </picture>
      </div>
    </div>
  </div>

  <!-- Navigation Controls -->
  <div class="slider-controls">
    <button
      mat-icon-button
      class="nav-btn prev-btn"
      (click)="prevSlide()"
      aria-label="Previous slide"
    >
      <mat-icon>chevron_left</mat-icon>
    </button>
    <button
      mat-icon-button
      class="nav-btn next-btn"
      (click)="nextSlide()"
      aria-label="Next slide"
    >
      <mat-icon>chevron_right</mat-icon>
    </button>
  </div>

  <!-- Slide Indicators/Dots -->
  <!-- Slide Indicators -->
  <div class="slide-indicators" role="tablist">
    <button
      *ngFor="let image of images; let i = index"
      class="indicator-dot"
      [class.active]="i === currentIndex"
      (click)="goToSlide(i)"
      [attr.aria-label]="'Go to slide ' + (i + 1)"
      [attr.aria-selected]="i === currentIndex"
      role="tab"
    ></button>
  </div>
</div>
